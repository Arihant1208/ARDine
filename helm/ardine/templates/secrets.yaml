apiVersion: v1
kind: Secret
metadata:
  name: {{ .Release.Name }}-secrets
  labels:
    app.kubernetes.io/name: ardine
    app.kubernetes.io/instance: {{ .Release.Name }}
type: Opaque
stringData:
  GEMINI_API_KEY: {{ .Values.secrets.geminiApiKey | quote }}
  GOOGLE_CLIENT_ID: {{ .Values.secrets.googleClientId | quote }}
  JWT_SECRET: {{ .Values.secrets.jwtSecret | quote }}
  STRIPE_SECRET_KEY: {{ .Values.secrets.stripeSecretKey | quote }}
  STRIPE_PUBLISHABLE_KEY: {{ .Values.secrets.stripePublishableKey | quote }}
  STRIPE_WEBHOOK_SECRET: {{ .Values.secrets.stripeWebhookSecret | quote }}
  {{- if .Values.postgresql.enabled }}
  DATABASE_URL: "postgresql://{{ .Values.postgresql.auth.username }}:{{ .Values.postgresql.auth.password }}@{{ .Release.Name }}-postgresql:5432/{{ .Values.postgresql.auth.database }}"
  {{- else }}
  DATABASE_URL: "postgresql://{{ .Values.externalDatabase.user }}:{{ .Values.externalDatabase.password }}@{{ .Values.externalDatabase.host }}:{{ .Values.externalDatabase.port }}/{{ .Values.externalDatabase.database }}"
  {{- end }}
  {{- if .Values.redis.enabled }}
  REDIS_URL: "redis://{{ .Release.Name }}-redis-master:6379"
  {{- else }}
  REDIS_URL: "redis://{{ .Values.externalRedis.host }}:{{ .Values.externalRedis.port }}"
  {{- end }}
  {{- if .Values.minio.enabled }}
  S3_ACCESS_KEY: {{ .Values.minio.rootUser | quote }}
  S3_SECRET_KEY: {{ .Values.minio.rootPassword | quote }}
  {{- else }}
  S3_ACCESS_KEY: {{ .Values.externalStorage.accessKey | quote }}
  S3_SECRET_KEY: {{ .Values.externalStorage.secretKey | quote }}
  {{- end }}
